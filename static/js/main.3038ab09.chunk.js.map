{"version":3,"sources":["BtcNet.js","BlockUI.js","TxUI.js","App.js","index.js"],"names":["BtcNet","ws","WebSocket","subscribeTo","val","a","readyState","OPEN","Promise","resolve","reject","currentAttempt","interval","setInterval","maxNumberOfAttempts","clearInterval","Error","send","JSON","stringify","op","console","error","startListen","onNewTxCallback","onNewBlockCallback","onmessage","evt","received_msg","parse","data","x","hash","getTxForBlock","readyCallback","axios","get","then","response","tx","catch","log","BlockUI","props","useState","posx","number","posy","rotx","setRotx","roty","setRoty","useFrame","position","rotation","scale","args","color","TxUI","Math","random","mesh","useRef","min","max","current","ref","App","transactions","Map","transactionsInBlocks","blocks","init","window","btcnet","onBlockTXsReceived","txsInBlock","size","forEach","txInBlock","has","delete","timesReported","set","forceUpdate","alert","txList","blockList","this","key","push","blockNr","className","class","camera","fov","map","Component","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.3038ab09.chunk.js","sourcesContent":["import axios from \"axios\";\n\nconst BtcNet = () => {\n  let ws = new WebSocket(\"wss://ws.blockchain.info/inv\");\n\n  const waitForOpenConnection = () => {\n    return new Promise((resolve, reject) => {\n      const maxNumberOfAttempts = 100;\n      const intervalTime = 100; //ms\n\n      let currentAttempt = 0;\n      const interval = setInterval(() => {\n        if (currentAttempt > maxNumberOfAttempts - 1) {\n          clearInterval(interval);\n          reject(new Error(\"Maximum number of attempts exceeded\"));\n        } else if (ws.readyState === ws.OPEN) {\n          clearInterval(interval);\n          resolve();\n        }\n        currentAttempt++;\n      }, intervalTime);\n    });\n  };\n\n  const subscribeTo = async (val) => {\n    if (ws.readyState !== ws.OPEN) {\n      try {\n        await waitForOpenConnection(ws);\n        ws.send(JSON.stringify({ op: val }));\n      } catch (err) {\n        console.error(err);\n      }\n    } else {\n      ws.send(JSON.stringify({ op: val }));\n    }\n  };\n\n  const startListen = (onNewTxCallback, onNewBlockCallback) => {\n    ws.onmessage = function (evt) {\n      let received_msg = JSON.parse(evt.data);\n      if (received_msg.op === \"utx\") {\n        onNewTxCallback(received_msg.x.hash);\n      }\n      if (received_msg.op === \"block\") {\n        onNewBlockCallback(received_msg.x.hash);\n      }\n    };\n  };\n\n  const getTxForBlock = (hash, readyCallback) => {\n    axios\n      .get(\"https://blockchain.info/rawblock/\" + hash + \"?&cors=true\")\n      .then(function (response) {\n        readyCallback(response.data.tx);\n      })\n      .catch(function (error) {\n        console.log(error);\n      })\n      .then(function () {});\n  };\n  return { subscribeTo, startListen, getTxForBlock };\n};\n\nexport default BtcNet;\n","import React, { useState } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\nconst BlockUI = (props) => {\n  const [posx, setPosx] = useState(100);\n  const [posy, setPosy] = useState(props.number * 20 - 75);\n  const [rotx, setRotx] = useState(0);\n  const [roty, setRoty] = useState(0);\n\n  useFrame(() => {\n    setRotx(rotx + 0.01);\n    setRoty(roty + 0.01);\n  });\n\n  return (\n    <mesh\n      position={[posx, posy, 0]}\n      rotation={[rotx, roty, 0]}\n      scale={[10, 10, 10]}\n    >\n      <boxBufferGeometry args={[1, 1, 1]} />\n      <meshStandardMaterial color={\"orange\"} />\n    </mesh>\n  );\n};\n\nexport default BlockUI;\n","import React, { useRef, useState } from \"react\";\nimport { useFrame } from \"react-three-fiber\";\n\nconst TxUI = (props) => {\n  const [posx, setPosx] = useState(-150);\n  const [posy, setPosy] = useState(Math.random() * 100 - 50);\n  const [rotx, setRotx] = useState(0);\n  const [roty, setRoty] = useState(0);\n  const mesh = useRef();\n\n  useFrame(() => {\n    //mesh.current.position.y = mesh.current.position.y + randomNumber(-0.1, 0.1);\n    if (mesh.current.position.x < 50) {\n      mesh.current.position.x =\n        mesh.current.position.x + randomNumber(0.2, 0.2);\n    } else {\n      //  mesh.current.position.x =\n      //    mesh.current.position.x + randomNumber(-0.1, 0.1);\n    }\n  });\n\n  function randomNumber(min, max) {\n    return Math.random() * (max - min) + min;\n  }\n  return (\n    <mesh\n      ref={mesh}\n      position={[posx, posy, 0]}\n      rotation={[rotx, roty, 0]}\n      scale={[0.5, 0.5, 0.5]}\n    >\n      <sphereBufferGeometry args={[1]} />\n      <meshStandardMaterial color={\"hotpink\"} />\n    </mesh>\n  );\n};\n\nexport default TxUI;\n","import \"./App.css\";\nimport BtcNet from \"./BtcNet\";\nimport BlockUI from \"./BlockUI\";\nimport { Canvas } from \"react-three-fiber\";\nimport React, { Component } from \"react\";\nimport TxUI from \"./TxUI\";\n\nclass App extends Component {\n  constructor() {\n    super();\n    this.transactions = new Map();\n    this.transactionsInBlocks = 0;\n    this.blocks = new Map();\n    this.init();\n  }\n\n  init() {\n    console.log(\"Init\");\n    if (\"WebSocket\" in window) {\n      let btcnet = BtcNet();\n\n      btcnet.subscribeTo(\"unconfirmed_sub\");\n      btcnet.subscribeTo(\"blocks_sub\");\n\n      const onNewTx = (hash) => {\n        const timesReported = this.transactions.get(hash);\n        if (timesReported > 0) this.transactions.set(hash, timesReported + 1);\n\n        this.transactions.set(hash, 1);\n        this.forceUpdate();\n      };\n\n      const onNewBlock = (hash) => {\n        const timesReported = this.blocks.get(hash);\n        if (timesReported > 0) this.blocks.set(hash, timesReported + 1);\n\n        this.blocks.set(hash, 1);\n        btcnet.getTxForBlock(hash, onBlockTXsReceived);\n      };\n      const onBlockTXsReceived = (txsInBlock) => {\n        console.log(\"Size before block: \" + this.transactions.size);\n        txsInBlock.forEach((txInBlock) => {\n          if (this.transactions.has(txInBlock.hash)) {\n            this.transactions.delete(txInBlock.hash);\n            this.transactionsInBlocks++;\n          }\n        });\n        console.log(\"Size after block: \" + this.transactions.size);\n      };\n\n      btcnet.startListen(onNewTx, onNewBlock);\n    } else {\n      alert(\"WebSocket NOT supported by your Browser!\");\n    }\n  }\n\n  render() {\n    let txList = [];\n    let blockList = [];\n    for (let [key, value] of this.transactions) {\n      txList.push(key);\n    }\n    let blockNr = 0;\n    for (let [key, value] of this.blocks) {\n      blockList.push(blockNr);\n      blockNr++;\n    }\n    return (\n      <div className=\"App\">\n        <div class=\"card\">\n          <div class=\"card-body\">\n            Pending transactions: {this.transactions.size}\n          </div>\n          <div class=\"card-body\">\n            Transactions in blocks: {this.transactionsInBlocks}\n          </div>\n        </div>\n\n        <Canvas camera={{ fov: 50, position: [0, 0, 200] }}>\n          <ambientLight />\n          <pointLight position={[10, 10, 10]} />\n\n          {txList.map((tx) => (\n            <TxUI key={tx} />\n          ))}\n\n          {blockList.map((blockNr) => (\n            <BlockUI key={blockNr} number={blockNr} />\n          ))}\n        </Canvas>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}
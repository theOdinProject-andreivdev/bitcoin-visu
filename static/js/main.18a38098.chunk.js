(this["webpackJsonpbitcoin-visu"]=this["webpackJsonpbitcoin-visu"]||[]).push([[0],{39:function(e,t,n){},40:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var c=n(5),o=n(0),r=n.n(o),a=n(29),i=n.n(a),s=(n(39),n(6)),u=n(2),b=(n(40),n(19)),f=n.n(b),j=n(30),h=n(31),O=n.n(h),l=function(){console.log("conn");var e=new WebSocket("wss://ws.blockchain.info/inv");return{subscribeTo:function(){var t=Object(j.a)(f.a.mark((function t(n){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.readyState===e.OPEN){t.next=12;break}return t.prev=1,t.next=4,new Promise((function(t,n){var c=0,o=setInterval((function(){c>99?(clearInterval(o),n(new Error("Maximum number of attempts exceeded"))):e.readyState===e.OPEN&&(clearInterval(o),t()),c++}),100)}));case 4:e.send(JSON.stringify({op:n})),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.error(t.t0);case 10:t.next=13;break;case 12:e.send(JSON.stringify({op:n}));case 13:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e){return t.apply(this,arguments)}}(),startListen:function(t,n){e.onmessage=function(e){var c=JSON.parse(e.data);"utx"===c.op&&t(c.x.hash),"block"===c.op&&n(c.x.hash)}},getTxForBlock:function(e,t){O.a.get("https://blockchain.info/rawblock/"+e+"?&cors=true").then((function(e){t(e.data.tx)})).catch((function(e){console.log(e)})).then((function(){}))}}},p=n(10),d=function(e){var t=Object(o.useState)(.09*e.width),n=Object(u.a)(t,2),r=n[0],a=(n[1],Object(o.useState)(20*e.number-75)),i=Object(u.a)(a,2),s=i[0],b=(i[1],Object(o.useState)(0)),f=Object(u.a)(b,2),j=f[0],h=f[1],O=Object(o.useState)(0),l=Object(u.a)(O,2),d=l[0],x=l[1];return Object(p.b)((function(){h(j+.01),x(d+.01)})),Object(c.jsxs)("mesh",{position:[r,s,0],rotation:[j,d,0],scale:[10,10,10],children:[Object(c.jsx)("boxBufferGeometry",{args:[1,1,1]}),Object(c.jsx)("meshLambertMaterial",{color:"orange"})]})},x=function(e){var t=Object(o.useState)(-.1*e.width),n=Object(u.a)(t,2),r=n[0],a=(n[1],Object(o.useState)(Math.random()*(.1*e.height)-.1*e.height/2)),i=Object(u.a)(a,2),s=i[0],b=(i[1],Object(o.useState)(0)),f=Object(u.a)(b,2),j=f[0],h=(f[1],Object(o.useState)(0)),O=Object(u.a)(h,2),l=O[0],d=(O[1],Object(o.useRef)());function x(e,t){return Math.random()*(t-e)+e}return Object(p.b)((function(){d.current.position.y=d.current.position.y+x(-.1,.1),0==e.value?(d.current.position.x=d.current.position.x+x(.1,.2),d.current.position.y=d.current.position.y+x(.1,.2)):d.current.position.x<.08*e.width?d.current.position.x=d.current.position.x+x(.1,.1):d.current.position.x=d.current.position.x+x(-.15,.1)})),Object(c.jsx)("mesh",{ref:d,position:[r,s,0],rotation:[j,l,0],scale:[1,1,1],geometry:e.geo,material:e.mat})},m=n(4),v=function(){var e=Object(o.useState)(new Map),t=Object(u.a)(e,2),n=t[0],r=t[1],a=Object(o.useState)(new Map),i=Object(u.a)(a,2),b=i[0],f=i[1],j=Object(o.useState)(0),h=Object(u.a)(j,2),O=h[0],v=h[1],g=Object(o.useState)(),w=Object(u.a)(g,2),S=w[0],k=w[1],y=Object(o.useState)(new m.CircleBufferGeometry(1,10,10)),M=Object(u.a)(y,1)[0],N=Object(o.useState)(new m.MeshBasicMaterial({color:"hotpink"})),E=Object(u.a)(N,1)[0];Object(o.useEffect)((function(){k(l())}),[]);var T=Object(o.useRef)(!0);Object(o.useEffect)((function(){T.current?T.current=!1:B()}),[S]);var B=function(){console.log("Init"),"WebSocket"in window?(S.subscribeTo("unconfirmed_sub"),S.subscribeTo("blocks_sub"),S.startListen(I,z)):alert("WebSocket NOT supported by your Browser!")},z=function(e){var t=b.get(e);t>0?f((function(n){return new Map([].concat(Object(s.a)(n),[[e,t+1]]))})):(b.size>5&&f(new Map),f((function(t){return new Map([].concat(Object(s.a)(t),[[e,1]]))})),setTimeout((function(){S.getTxForBlock(e,J)}),3e3))},I=function(e){var t=n.get(e);r(t>0?function(n){return new Map([].concat(Object(s.a)(n),[[e,t+1]]))}:function(t){return new Map([].concat(Object(s.a)(t),[[e,1]]))})},J=function(e){console.log("Size before block: "+n.size),e.forEach((function(e){n.has(e.hash)&&(r((function(t){return new Map([].concat(Object(s.a)(t),[[e.hash,0]]))})),v(O+1))})),console.log("Size after block: "+n.size)},L=[],W=[];n.forEach((function(e){L.push(e)}));var P=0;b.forEach((function(){W.push(P++)}));var F=document.querySelector("canvas");return Object(c.jsx)("div",{className:"App",children:Object(c.jsxs)("div",{style:{display:"grid",height:"100%"},children:[Object(c.jsxs)("div",{className:"card",children:[Object(c.jsxs)("div",{className:"card-body",children:["Pending transactions: ",n.size]}),Object(c.jsxs)("div",{className:"card-body",children:["Transactions in blocks: ",O]})]}),Object(c.jsxs)(p.a,{className:"canvas",camera:{fov:50,position:[0,0,200]},children:[Object(c.jsx)("ambientLight",{}),Object(c.jsx)("pointLight",{position:[10,10,10]}),L.map((function(e){return Object(c.jsx)(x,{value:e,width:F.offsetWidth,height:F.offsetHeight,geo:M,mat:E})})),W.map((function(e){return Object(c.jsx)(d,{number:e,width:F.offsetWidth,height:F.offsetHeight},e)}))]})]})})};i.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(v,{})}),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.18a38098.chunk.js.map